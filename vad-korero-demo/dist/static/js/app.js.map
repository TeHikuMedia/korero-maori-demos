{"version":3,"sources":["webpack:///./src/App.vue?72a8","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///./src/public/lib/encoder.js","webpack:///./src/lib/vad.js","webpack:///./src/public/lib/visualize.js","webpack:///./src/public/lib/recorder.js","webpack:///src/components/Korero.vue","webpack:///./src/components/Korero.vue?7581","webpack:///./src/components/Korero.vue","webpack:///./src/router/index.js","webpack:///./src/main.js"],"names":["selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","name","ssrContext","_class","config","classCallCheck_default","bitRate","sampleRate","dataBuffer","encoder","Mp3Encoder","X","slice","length","arrayBuffer","samples","_convertBuffer","remaining","i","left","subarray","buffer","encodeBuffer","push","Int8Array","flush","blob","Blob","type","Date","now","url","URL","createObjectURL","input","output","s","Math","max","min","data","Float32Array","out","Int16Array","_floatTo16BitPCM","VAD","options","option","fftSize","bufferLen","voice_stop","voice_start","smoothingTimeConstant","energy_offset","energy_threshold_ratio_pos","energy_threshold_ratio_neg","energy_integration","filter","f","v","source","context","debug","hasOwnProperty","Error","hertzPerBin","iterationFrequency","iterationPeriod","console","log","setFilter","shape","iLen","j","jLen","ready","vadState","energy_threshold_pos","energy_threshold_neg","voiceTrend","voiceTrendMax","voiceTrendMin","voiceTrendStart","voiceTrendEnd","damper","analyser","createAnalyser","floatFrequencyData","frequencyBinCount","floatFrequencyDataLinear","connect","scriptProcessorNode","createScriptProcessor","destination","self","onaudioprocess","event","getFloatFrequencyData","update","monitor","logging","log_i","log_limit","triggerLog","limit","msg","fft","pow","getEnergy","energy","signal","start","end","integration","canvas_id","sourceNode","audioContext","canvas","document","getElementById","canvasContext","getContext","loop","bufferLength","dataArray","Uint8Array","window","setTimeout","clearFrame","width","clientWidth","height","clientHeight","WIDTH","HEIGHT","renderFrame","requestAnimationFrame","getByteFrequencyData","fillStyle","fillRect","barWidth","parseInt","barHeight","x","l","clearRect","arguments","undefined","beforeRecording","pauseRecording","putRecording","afterRecording","micFailed","voiceStop","voiceStart","visCanvasID","canvasID","bufferSize","records","isPause","isRecording","duration","volume","_duration","vad","vis","activity","navigator","mediaDevices","getUserMedia","video","audio","channelCount","echoCancellation","then","_micCaptured","bind","catch","_micError","lameEncoder","Encoder","stop","stream","getTracks","forEach","track","disconnect","processor","close","record","finish","convertTimeMMSS","_this","AudioContext","webkitAudioContext","createMediaStreamSource","_voiceStop","put","_voiceStart","error","ev","flushPrevious","sample","inputBuffer","getChannelData","sum","encode","parseFloat","currentTime","toFixed","sqrt","axios","Korero","vadOn","recordingOn","recorder","buttonText","transcriptions","methods","deleteObject","e","splice","mounted","startVAD","onclick","transcription","status","text","formData","FormData","enctype","append","post","headers","Authorization","response","pop","classList","remove","contains","add","components_Korero","_vm","staticClass","_v","_s","class","active","_l","item","index","on","click","$event","_e","src","audio_url","controls","src_components_Korero","Korero_normalizeComponent","Vue","use","Router","router","routes","path","component","vueCustomElement","App","customElement"],"mappings":"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","file":"static/js/app.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0814503c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0814503c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0814503c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'App'\n}\n</script>\n\n<style>\nhtml, body{\n  padding: 0px;\n  margin: 0px;\n}\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","import { Mp3Encoder } from 'lamejs'\n\nexport default class {\n  constructor(config) {\n    this.bitRate    = config.bitRate || 128\n    this.sampleRate = config.sampleRate || 44100\n    this.dataBuffer = []\n    this.encoder    = new Mp3Encoder(1, this.sampleRate, this.bitRate)\n  }\n\n  flushPrevious(X){\n    // This clears X items in the buffer\n    this.dataBuffer = this.dataBuffer.slice(this.dataBuffer.length - X)\n  }\n\n  encode(arrayBuffer) {\n    const maxSamples = 1152\n    const samples    = this._convertBuffer(arrayBuffer)\n    let remaining    = samples.length\n\n    for (let i = 0; remaining >= 0; i += maxSamples) {\n      const left = samples.subarray(i, i + maxSamples)\n      const buffer = this.encoder.encodeBuffer(left)\n      this.dataBuffer.push(new Int8Array(buffer))\n      remaining -= maxSamples\n    }\n  }\n\n  finish() {\n    this.dataBuffer.push(this.encoder.flush())\n    const blob = new Blob(this.dataBuffer, { type: 'audio/mp3' })\n    this.dataBuffer = []\n\n    return {\n      id    : Date.now(),\n      blob  : blob,\n      url   : URL.createObjectURL(blob)\n    }\n  }\n\n  _floatTo16BitPCM(input, output) {\n    for (let i = 0; i < input.length; i++) {\n      const s = Math.max(-1, Math.min(1, input[i]))\n      output[i] = (s < 0 ? s * 0x8000 : s * 0x7FFF)\n    }\n  }\n\n  _convertBuffer(arrayBuffer) {\n    const data = new Float32Array(arrayBuffer)\n    const out = new Int16Array(arrayBuffer.length)\n    this._floatTo16BitPCM(data, out)\n    return out\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/encoder.js","\nexport default class VAD {\n\n  constructor(options) {\n    // Default options\n    this.options = {\n      fftSize: 512*.5,\n      bufferLen: 512*.5, \n      voice_stop: function() {},\n      voice_start: function() {},\n      smoothingTimeConstant: 0.99, \n      energy_offset: 1e-8, // The initial offset.\n      energy_threshold_ratio_pos: 4, // Signal must be twice the offset\n      energy_threshold_ratio_neg: 0.25, // Signal must be half the offset\n      energy_integration: 1, // Size of integration change compared to the signal per second.\n      filter: [\n        {f: 200, v:0}, // 0 -> 200 is 0\n        {f: 2000, v:1} // 200 -> 2k is 1\n      ],\n      source: null,\n      context: null,\n      debug: false,\n    };\n\n    // User options\n    for(var option in options) {\n      if(options.hasOwnProperty(option)) {\n        this.options[option] = options[option];\n      }\n    }\n\n    // Require source\n   if(!this.options.source)\n     throw new Error(\"The options must specify a MediaStreamAudioSourceNode.\");\n\n    // Set this.options.context\n    this.options.context = this.options.source.context;\n\n    // Calculate time relationships\n    this.hertzPerBin = this.options.context.sampleRate / this.options.fftSize;\n    this.iterationFrequency = this.options.context.sampleRate / this.options.bufferLen;\n    this.iterationPeriod = 1 / this.iterationFrequency;\n\n    var DEBUG = this.options.debug;\n    if(DEBUG) {console.log(\n      'Vad' +\n      ' | sampleRate: ' + this.options.context.sampleRate +\n      ' | hertzPerBin: ' + this.hertzPerBin +\n      ' | iterationFrequency: ' + this.iterationFrequency +\n      ' | iterationPeriod: ' + this.iterationPeriod\n    )};\n\n    this.setFilter = function(shape) {\n      this.filter = [];\n      for(var i = 0, iLen = this.options.fftSize / 2; i < iLen; i++) {\n        this.filter[i] = 0;\n        for(var j = 0, jLen = shape.length; j < jLen; j++) {\n          if(i * this.hertzPerBin < shape[j].f) {\n            this.filter[i] = shape[j].v;\n            break; // Exit j loop\n          }\n        }\n      }\n    }\n\n    this.setFilter(this.options.filter);\n\n    this.ready = {};\n    this.vadState = false; // True when Voice Activity Detected\n\n    // Energy detector props\n    this.energy_offset = this.options.energy_offset;\n    this.energy_threshold_pos = this.energy_offset * this.options.energy_threshold_ratio_pos;\n    this.energy_threshold_neg = this.energy_offset * this.options.energy_threshold_ratio_neg;\n\n    this.voiceTrend = 0;\n    this.voiceTrendMax = 10*1.5;\n    this.voiceTrendMin = -5;\n    this.voiceTrendStart = 2;\n    this.voiceTrendEnd = -5;\n    this.damper = 0.025\n    this.voiceTrendMin = this.voiceTrendEnd - this.damper/10;\n    // Create analyser \n    this.analyser = this.options.context.createAnalyser();\n    this.analyser.smoothingTimeConstant = this.options.smoothingTimeConstant; // 0.99;\n    this.analyser.fftSize = this.options.fftSize;\n\n    this.floatFrequencyData = new Float32Array(this.analyser.frequencyBinCount);\n\n    // Setup local storage of the Linear FFT data\n    this.floatFrequencyDataLinear = new Float32Array(this.floatFrequencyData.length);\n\n    // Connect this.analyser\n    this.options.source.connect(this.analyser); \n\n    // Create ScriptProcessorNode\n    this.scriptProcessorNode = this.options.context.createScriptProcessor(this.options.bufferLen, 1, 1);\n\n    // Connect scriptProcessorNode (Theretically, not required)\n    this.scriptProcessorNode.connect(this.options.context.destination);\n\n    // Create callback to update/analyze floatFrequencyData\n    var self = this;\n    this.scriptProcessorNode.onaudioprocess = function(event) {\n      self.analyser.getFloatFrequencyData(self.floatFrequencyData);\n      self.update();\n      self.monitor();\n    };\n\n    // Connect scriptProcessorNode\n    this.options.source.connect(this.scriptProcessorNode);\n\n    // log stuff\n    this.logging = false;\n    this.log_i = 0;\n    this.log_limit = 100;\n\n    this.triggerLog = function(limit) {\n      this.logging = true;\n      this.log_i = 0;\n      this.log_limit = typeof limit === 'number' ? limit : this.log_limit;\n    }\n\n    this.log = function(msg) {\n      if(this.logging && this.log_i < this.log_limit) {\n        this.log_i++;\n        console.log(msg);\n      } else {\n        this.logging = false;\n      }\n    }\n\n    this.update = function() {\n      // Update the local version of the Linear FFT\n      var fft = this.floatFrequencyData;\n      for(var i = 0, iLen = fft.length; i < iLen; i++) {\n        this.floatFrequencyDataLinear[i] = Math.pow(10, fft[i] / 10);\n      }\n      this.ready = {};\n    }\n\n    this.getEnergy = function() {\n      if(this.ready.energy) {\n        return this.energy;\n      }\n\n      var energy = 0;\n      var fft = this.floatFrequencyDataLinear;\n\n      for(var i = 0, iLen = fft.length; i < iLen; i++) {\n        energy += this.filter[i] * fft[i] * fft[i];\n      }\n\n      this.energy = energy;\n      this.ready.energy = true;\n\n      return energy;\n    }\n\n    this.monitor = function() {\n      var energy = this.getEnergy();\n      var signal = energy - this.energy_offset;\n\n      if(signal > this.energy_threshold_pos) {\n        this.voiceTrend = (this.voiceTrend + 1 > this.voiceTrendMax) ? this.voiceTrendMax : this.voiceTrend + 1;\n      } else if(signal < -this.energy_threshold_neg) {\n        this.voiceTrend = (this.voiceTrend - 1 < this.voiceTrendMin) ? this.voiceTrendMin : this.voiceTrend - 1*(this.vadState ? this.damper : 10);\n      } else {\n        // voiceTrend gets smaller\n        if(this.voiceTrend > 0) {\n          this.voiceTrend--;\n        } else if(this.voiceTrend < 0) {\n          this.voiceTrend++;\n        }\n      }\n\n      var start = false, end = false;\n      if(this.voiceTrend > this.voiceTrendStart) {\n        // Start of speech detected\n        start = true;\n      } else if(this.voiceTrend < this.voiceTrendEnd) {\n        // End of speech detected\n        end = true;\n      }\n\n      // Integration brings in the real-time aspect through the relationship with the frequency this functions is called.\n      var integration = signal * this.iterationPeriod * this.options.energy_integration;\n\n      // Idea?: The integration is affected by the voiceTrend magnitude? - Not sure. Not doing atm.\n\n      // The !end limits the offset delta boost till after the end is detected.\n      if(integration > 0 || !end) {\n        this.energy_offset += integration;\n      } else {\n        this.energy_offset += integration * 10;\n      }\n      this.energy_offset = this.energy_offset < 0 ? 0 : this.energy_offset;\n      this.energy_threshold_pos = this.energy_offset * this.options.energy_threshold_ratio_pos;\n      this.energy_threshold_neg = this.energy_offset * this.options.energy_threshold_ratio_neg;\n\n      // Broadcast the messages\n      if(start && !this.vadState) {\n        this.vadState = true;\n        this.options.voice_start();\n      }\n      if(end && this.vadState) {\n        this.vadState = false;\n        this.options.voice_stop();\n      }\n\n      this.log(\n        'e: ' + energy +\n        ' | e_of: ' + this.energy_offset +\n        ' | e+_th: ' + this.energy_threshold_pos +\n        ' | e-_th: ' + this.energy_threshold_neg +\n        ' | signal: ' + signal +\n        ' | int: ' + integration +\n        ' | voiceTrend: ' + this.voiceTrend +\n        ' | start: ' + start +\n        ' | end: ' + end\n      );\n\n      return signal;\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/vad.js","\nexport default class {\n\n  constructor(canvas_id, sourceNode, audioContext){\n    var self = this\n    this.canvas = document.getElementById(canvas_id)\n    this.canvasContext = this.canvas.getContext(\"2d\")\n    this.loop = false\n    this.sourceNode = sourceNode\n    this.audioContext = audioContext\n    this.analyser = audioContext.createAnalyser();\n    this.analyser.fftSize = 32;\n\n\n    this.sourceNode.connect(this.analyser);\n    \n    this.bufferLength = this.analyser.frequencyBinCount;\n    this.dataArray = new Uint8Array(this.analyser.fftSize);\n\n  }\n\n  stop(){\n    this.loop = false\n    var self = this\n    window.setTimeout(function(){self.clearFrame()}, 200)\n  }\n\n  start(){\n    this.canvas.width = this.canvas.clientWidth;\n    this.canvas.height = this.canvas.clientHeight;    \n    this.WIDTH = this.canvas.clientWidth;\n    this.HEIGHT = this.canvas.clientHeight;    \n    this.loop = true\n    this.renderFrame();\n  }\n\n  renderFrame() {\n    var self = this\n    if (self.loop){\n      \n        window.requestAnimationFrame(function(){self.renderFrame()});\n        self.analyser.getByteFrequencyData(self.dataArray);\n        // self.canvasContext.clearRect(0, 0, self.WIDTH, self.HEIGHT);\n        self.canvasContext.fillStyle = \"#333\";\n        self.canvasContext.fillRect(0, 0, self.WIDTH, self.HEIGHT);\n\n        var barWidth = parseInt((self.WIDTH / self.bufferLength))\n        var barHeight = 0\n        var x = 0;\n\n        for (var i = 0; i < self.bufferLength/2; i++) {\n          barHeight = parseInt(self.dataArray[i]/255*self.HEIGHT*.9);\n          \n          var h = 345\n          var s = parseInt(73 * ( self.HEIGHT/barHeight * .5) )\n          var l = parseInt(90 * ( barHeight/self.HEIGHT))\n          \n          self.canvasContext.fillStyle = \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\";\n          self.canvasContext.fillRect(2*x+1, self.HEIGHT - barHeight, 2*barWidth-2, barHeight);\n\n          x += barWidth;\n\n      }\n      \n    } else {\n      return;\n    }\n  }\n\n  clearFrame(){\n    var self = this\n    self.canvasContext.clearRect(0, 0, self.WIDTH, self.HEIGHT);\n    self.canvasContext.fillStyle = \"#333\";\n    self.canvasContext.fillRect(0, 0, self.WIDTH, self.HEIGHT);    \n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/visualize.js","import Encoder from './encoder'\nimport { convertTimeMMSS } from '../../../node_modules/vue-audio-recorder/src/lib/utils'\nimport VAD from '../../lib/vad.js'\nimport vis from './visualize'\n\nexport default class {\n  constructor (options = {}) {\n    this.beforeRecording = options.beforeRecording\n    this.pauseRecording  = options.pauseRecording\n    this.putRecording    = options.putRecording\n    this.afterRecording  = options.afterRecording\n    this.micFailed       = options.micFailed\n    this.voiceStop       = options.voiceStop\n    this.voiceStart      = options.voiceStart\n    this.visCanvasID     = options.canvasID\n\n    this.bufferSize = 4096\n    this.records    = []\n\n    this.isPause     = false\n    this.isRecording = false\n\n    this.duration = 0\n    this.volume   = 0\n\n    this._duration = 0\n\n    this.vad = null\n    this.vis = null\n    this.activity = false\n    this.flush = false\n\n    this.vis = null\n\n  }\n\n  start () {\n    const constraints = {\n      video: false,\n      audio: {\n        channelCount: 1,\n        echoCancellation: true\n      }\n    }\n\n    this.beforeRecording && this.beforeRecording('start recording')\n\n    navigator.mediaDevices\n             .getUserMedia(constraints)\n             .then(this._micCaptured.bind(this))\n             .catch(this._micError.bind(this))\n    this.isPause = false\n    this.isRecording = true\n    this.lameEncoder = new Encoder({})\n  }\n\n  stop () {\n    this.vis.stop()\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    const record = this.lameEncoder.finish()\n    record.duration = convertTimeMMSS(this.duration)\n    // this.records.push(record)\n\n    this._duration = 0\n    this.duration  = 0\n\n    this.isPause     = false\n    this.isRecording = false\n\n    this.afterRecording && this.afterRecording(record)\n    \n  }\n\n  put () {\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    const record = this.lameEncoder.finish()\n    record.duration = convertTimeMMSS(this.duration)\n    this.records.push(record)\n\n    this._duration = 0\n    this.duration  = 0\n\n    this.isPause     = false\n    this.isRecording = false\n    this.putRecording && this.putRecording(record)\n\n  }\n\n  pause () {\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    this._duration = this.duration\n    this.isPause = true\n\n    this.pauseRecording && this.pauseRecording('pause recording')\n  }\n\n  recordList () {\n    return this.records\n  }\n\n  lastRecord () {\n    return this.records.slice(-1)\n  }\n\n  _micCaptured (stream) {\n    this.context    = new(window.AudioContext || window.webkitAudioContext)()\n    this.duration   = this._duration\n    this.input      = this.context.createMediaStreamSource(stream)\n    this.processor  = this.context.createScriptProcessor(this.bufferSize, 1, 1)\n    this.stream     = stream\n\n    this._voiceStop = () => {\n      this.voiceStop()\n      this.activity = false\n      this.put()\n      this.start()\n    }\n    this._voiceStart = () => {\n      this.voiceStart()\n      this.activity = true\n      this.flush = true\n    }\n\n    var options = {\n      debug: true,\n      source: this.input,\n      voice_stop: this._voiceStop,\n      voice_start: this._voiceStart,\n    }; \n        \n    // Create VAD\n    this.vad = new VAD(options)\n    \n    if (this.visCanvasID){\n      try{\n        this.vis = new vis(this.visCanvasID, this.input, this.input.context)\n        this.vis.start()\n      } catch(error){\n        console.log(error)\n      }\n    }\n\n    this.processor.onaudioprocess = (ev) => {\n      if (this.activity){\n        if (this.flush){\n          this.lameEncoder.flushPrevious(10*1.5)\n          this.flush = false\n        }\n      } else {\n      }\n      const sample = ev.inputBuffer.getChannelData(0)\n      let sum = 0.0\n\n      this.lameEncoder.encode(sample)\n\n      for (let i = 0; i < sample.length; ++i) {\n        sum += sample[i] * sample[i]\n      }\n\n      this.duration = parseFloat(this._duration) + parseFloat(this.context.currentTime.toFixed(2))\n      this.volume = Math.sqrt(sum / sample.length).toFixed(2)\n    }\n\n    this.input.connect(this.processor)\n    this.processor.connect(this.context.destination)\n  }\n\n  _micError (error) {\n    this.micFailed && this.micFailed(error)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/recorder.js","<template>\n  <div class=\"Korero\">\n    <div class=\"header\">\n      <button id=\"startVAD\">{{buttonText}}</button>\n      <div id=\"vadStatus\" v-bind:class=\"{ active: vadOn }\">\n        <canvas id=\"canvas\"></canvas>\n      </div>\n    </div>\n\n    <div class=\"body\">\n      <div id=\"transcriptions\">\n        <div v-for=\"(item, index) in transcriptions\" class='transcription' v-if=\"item.status != 'Failed'\"> \n          <button class=\"delete\"  v-on:click=\"deleteObject(index)\">delete</button>\n          <div v-if=\"item.status == 'Transcribing'\" class=\"text\">\n            {{item.status}}\n          </div>\n          <div v-if=\"item.text\" class='text'>\n            {{item.text}}\n          </div>\n          <div class=\"audio\">\n            <audio v-if=\"item.audio_url\" :src=\"item.audio_url\" type=\"audio/mp3\" controls></audio>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport recorder from '../public/lib/recorder.js'\nconst axios = require('axios');\nexport default {\n  name: 'Kōrero',\n  data () {\n    return {\n      vadOn: false,\n      recordingOn: false,\n      recorder: null,\n      buttonText: 'Start',\n      transcriptions: [],\n    }\n  },\n  methods: {\n    deleteObject: function (e) {\n      this.transcriptions.splice(e, 1)\n    },\n  },\n  mounted: function () {\n\n    startVAD.onclick = event => {\n\n      if (this.recorder==null){\n        this.recorder = new recorder({\n          putRecording : (record) => {\n            var transcription = {\n              status: 'Transcribing',\n              text: null,\n              audio: null,\n            }\n            this.transcriptions.push(transcription)\n\n            // var div = document.createElement('div')\n            // var xt = document.createElement('div')\n            // xt.innerText = 'Transcribing...'\n            // div.classList.add('transcription')\n            // xt.classList.add('text')\n            // // div.append(xt)\n            // transcriptions.insertBefore(div, transcriptions.firstChild)\n            var formData = new FormData();\n            formData.enctype=\"multipart/form-data\";\n            formData.append('audio_file', record.blob, 'audio_file.mp3')            \n            axios.post(\n              'https://corporalocal.io/api/transcription/?method=stream',\n              // 'https://koreromaori.io/api/transcription/?method=stream',\n              formData,\n              {\n                headers: {\n                  Authorization: \"Token 899f4739922881b0008716d7253269af9a77ca5e\"},//0d0f9ebb85d621d7853052cd17f370e481379c6f\"},\n              },\n              )\n            .then((response) => {\n              if (response.data.transcription == '' || response.data.transcription == ' ' ){\n                // div.remove()\n                this.transcriptions.pop()\n                transcription.status = 'Failed'\n                // transcription.delete()\n                return\n              }\n              // xt.innerText = response.data.transcription\n              transcription['text'] = response.data.transcription\n              transcription['audio_url'] = record.url\n              transcription['status'] = 'Success'\n              // var audio = document.createElement('audio')\n              // audio.controls = 'controls';\n              // audio.src =  record.url;\n              // audio.type = 'audio/mp3';\n              // // div.append(audio)\n\n\n\n            })\n            .catch((error) => {\n              transcription.status = 'Failed'\n              // transcription.delete()\n              this.transcriptions.pop()\n            })\n\n          },\n          afterRecording  : (stream) =>{\n            startVAD.classList.remove('on')\n            this.buttonText = 'Start'            \n            this.recorder=null;\n          },\n          pauseRecording  : function(){console.log('paused')},\n          micFailed       : function(){console.log('failed')},\n          voiceStop: () => {\n            \n            this.vadOn = false\n          },\n          voiceStart: () => {\n            this.vadOn = true\n\n          },\n          canvasID: 'canvas',\n          bitRate         : 64,\n          sampleRate      : 22000,\n          // format          : this.format\n        })\n      }\n\n      if (startVAD.classList.contains('on')){\n        this.recorder.stop();\n        startVAD.classList.remove('on')\n        this.recorder=null;\n        this.vadOn = false;\n        // this.buttonText = 'Start'\n      } else {\n        this.recorder.start()\n        startVAD.classList.add('on')\n        this.buttonText = 'Stop'\n      }\n      \n\n      }\n  }\n}\n</script>\n\n<style scoped>\nbutton.delete{\n  position: absolute;\n  right: 0px;\n  top: 0px;\n  display: block;\n  margin: 15px;  \n}\n.transcription{\n  position: relative;\n  width: 100%;\n  margin: 20px 30px 20px 30px;\n  max-width: 500px;\n  /*margin-top: 20px; */\n  font-size: 1.5em;\n  border-radius: 8px;\n  /*box-shadow: 0px 2px 6px -2px rgba(0,0,0,1)  */\n  border: 1px solid black;\n}\n\n.transcription .text {\n  padding-top: 15px;\n  padding-bottom: 15px\n}\n\n.Korero, .header, .body{\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.body{\n  height: 100vh;\n  margin-top: -463px;\n  padding-top: 250px;\n}\n.header{\n  padding-bottom: 15px;\n  z-index: 1;\n  background-color: white;\n  /*box-shadow: 0 -2px 10px black;*/\n  border-bottom: 2px solid black;\n}\n#transcriptions{\n  z-index: 0;\n  overflow-y: scroll;  \n  display: flex;\n  flex-direction: column-reverse;\n  justify-content: flex-end;\n  align-items: center;  \n  margin-top: 215px;\n  height: 100vh;    \n  /*border-top: 2px solid black;*/\n}\n\n#vadStatus{\n  display: flex;\n  width: 100%;\n  max-width: 560px;  \n  height: 100px;\n  align-self: center;\n  align-items: center;\n  border: 4px solid black;\n  border-radius: 4px;\n\n}\n#vadStatus.active{\n  background-color: red;\n  border: 4px solid red;\n}\n#vadStatus canvas{\n  z-index: 1;\n  display: block;\n  height: 100%;\n  width: 100%;\n  background-color: #333;\n}\n#startVAD {\n  z-index: 2;\n  align-self: center;\n  margin: 15px;\n  outline: none;\n  background-color: rgb(40,40,40);\n  color: white;\n  width: 150px;\n  font-size: 2em;\n  border: 2px solid black;\n  border-radius: 8px;\n  padding: 8px 16px;\n  cursor: pointer;\n}\n#startVAD.on {\n  background-color: rgb(255, 40, 40);\n  border-color: rgb(200, 40, 40);;\n}\naudio{\n  outline: none;\n  width: 100%;\n  padding-bottom: 15px;\n}\n.audio{\n  padding: 0px 15px 0px 15px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Korero.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"Korero\"},[_c('div',{staticClass:\"header\"},[_c('button',{attrs:{\"id\":\"startVAD\"}},[_vm._v(_vm._s(_vm.buttonText))]),_vm._v(\" \"),_c('div',{class:{ active: _vm.vadOn },attrs:{\"id\":\"vadStatus\"}},[_c('canvas',{attrs:{\"id\":\"canvas\"}})])]),_vm._v(\" \"),_c('div',{staticClass:\"body\"},[_c('div',{attrs:{\"id\":\"transcriptions\"}},_vm._l((_vm.transcriptions),function(item,index){return (item.status != 'Failed')?_c('div',{staticClass:\"transcription\"},[_c('button',{staticClass:\"delete\",on:{\"click\":function($event){return _vm.deleteObject(index)}}},[_vm._v(\"delete\")]),_vm._v(\" \"),(item.status == 'Transcribing')?_c('div',{staticClass:\"text\"},[_vm._v(\"\\n          \"+_vm._s(item.status)+\"\\n        \")]):_vm._e(),_vm._v(\" \"),(item.text)?_c('div',{staticClass:\"text\"},[_vm._v(\"\\n          \"+_vm._s(item.text)+\"\\n        \")]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"audio\"},[(item.audio_url)?_c('audio',{attrs:{\"src\":item.audio_url,\"type\":\"audio/mp3\",\"controls\":\"\"}}):_vm._e()])]):_vm._e()}),0)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-39065281\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Korero.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-39065281\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Korero.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Korero.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Korero.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-39065281\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Korero.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-39065281\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Korero.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Korero from '@/components/Korero'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'VAD Kōrero Māori API Demo',\n      component: Korero\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","import Vue from 'vue'\nimport App from './App'\nimport router from './router'\n\nimport vueCustomElement from 'vue-custom-element'\nVue.use(vueCustomElement)\n\n// Vue.config.productionTip = false\n\nApp.router = router\nVue.customElement('vue-widget', App)\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}