{"version":3,"sources":["webpack:///./api_auth.js","webpack:///./src/App.vue?72a8","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///./src/public/lib/encoder.js","webpack:///./src/lib/vad.js","webpack:///./src/public/lib/visualize.js","webpack:///./src/public/lib/recorder.js","webpack:///src/components/Korero.vue","webpack:///./src/components/Korero.vue?dd0f","webpack:///./src/components/Korero.vue","webpack:///./src/router/index.js","webpack:///./src/main.js"],"names":["api_auth","headers","Authorization","url","exports","selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","name","ssrContext","_class","config","classCallCheck_default","bitRate","sampleRate","dataBuffer","encoder","Mp3Encoder","console","log","X","slice","length","arrayBuffer","samples","_convertBuffer","remaining","i","left","subarray","buffer","encodeBuffer","push","Int8Array","flush","blob","Blob","type","Date","now","URL","createObjectURL","input","output","s","Math","max","min","data","Float32Array","out","Int16Array","_floatTo16BitPCM","VAD","options","option","fftSize","bufferLen","voice_stop","voice_start","smoothingTimeConstant","energy_offset","energy_threshold_ratio_pos","energy_threshold_ratio_neg","energy_integration","filter","f","v","source","context","debug","hasOwnProperty","Error","hertzPerBin","iterationFrequency","iterationPeriod","setFilter","shape","iLen","j","jLen","ready","vadState","energy_threshold_pos","energy_threshold_neg","voiceTrend","voiceTrendMax","voiceTrendMin","voiceTrendStart","voiceTrendEnd","damper","analyser","createAnalyser","floatFrequencyData","frequencyBinCount","floatFrequencyDataLinear","connect","scriptProcessorNode","createScriptProcessor","destination","self","onaudioprocess","event","getFloatFrequencyData","update","monitor","logging","log_i","log_limit","triggerLog","limit","msg","fft","pow","getEnergy","energy","signal","start","end","integration","canvas_id","sourceNode","audioContext","canvas","document","getElementById","canvasContext","getContext","loop","bufferLength","dataArray","Uint8Array","window","setTimeout","clearFrame","width","clientWidth","height","clientHeight","WIDTH","HEIGHT","renderFrame","requestAnimationFrame","getByteFrequencyData","fillStyle","fillRect","barWidth","parseInt","barHeight","x","l","clearRect","arguments","undefined","beforeRecording","pauseRecording","putRecording","afterRecording","micFailed","voiceStop","voiceStart","visCanvasID","canvasID","bufferSize","records","isPause","isRecording","duration","volume","_duration","vad","vis","activity","AudioContext","webkitAudioContext","close","navigator","mediaDevices","getUserMedia","video","audio","channelCount","echoCancellation","then","_micCaptured","bind","catch","_micError","lameEncoder","Encoder","stop","stream","getTracks","forEach","track","disconnect","processor","record","finish","convertTimeMMSS","_this","createMediaStreamSource","_voiceStop","put","_voiceStart","error","ev","flushPrevious","sample","inputBuffer","getChannelData","sum","encode","parseFloat","currentTime","toFixed","sqrt","axios","Korero","vadOn","recordingOn","recorder","buttonText","transcriptions","methods","deleteObject","e","splice","mounted","startVAD","onclick","transcription","status","text","formData","FormData","enctype","append","post","response","pop","classList","remove","contains","add","components_Korero","_vm","staticClass","_v","_s","class","active","_l","item","index","on","click","$event","_e","src","audio_url","controls","src_components_Korero","Korero_normalizeComponent","Vue","use","Router","router","routes","path","component","vueCustomElement","App","customElement"],"mappings":"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","file":"static/js/app.js","sourcesContent":["api_auth = {\n\theaders:{\n\t\tAuthorization: \"Token 0d0f9ebb85d621d7853052cd17f370e481379c6f\",\n\t},\n\turl: 'https://koreromaori.io/api/transcription/?method=stream'\n}\n\nexports.api_auth = api_auth\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./api_auth.js\n// module id = BLBT\n// module chunks = 1","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0814503c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0814503c\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0814503c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'App'\n}\n</script>\n\n<style>\nhtml, body{\n  padding: 0px;\n  margin: 0px;\n}\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","import { Mp3Encoder } from 'lamejs'\n\nexport default class {\n  constructor(config) {\n    this.bitRate    = config.bitRate || 96\n    this.sampleRate = config.sampleRate || 44100\n    this.dataBuffer = []\n    this.encoder    = new Mp3Encoder(1, this.sampleRate, this.bitRate)\n    console.log(this.bitRate)\n    console.log(this.sampleRate)\n  }\n\n  flushPrevious(X){\n    // This clears X items in the buffer\n    this.dataBuffer = this.dataBuffer.slice(this.dataBuffer.length - X)\n  }\n\n  encode(arrayBuffer) {\n    const maxSamples = 1152\n    const samples    = this._convertBuffer(arrayBuffer)\n    let remaining    = samples.length\n\n    for (let i = 0; remaining >= 0; i += maxSamples) {\n      const left = samples.subarray(i, i + maxSamples)\n      const buffer = this.encoder.encodeBuffer(left)\n      this.dataBuffer.push(new Int8Array(buffer))\n      remaining -= maxSamples\n    }\n  }\n\n  finish() {\n    this.dataBuffer.push(this.encoder.flush())\n    const blob = new Blob(this.dataBuffer, { type: 'audio/mp3' })\n    this.dataBuffer = []\n\n    return {\n      id    : Date.now(),\n      blob  : blob,\n      url   : URL.createObjectURL(blob)\n    }\n  }\n\n  _floatTo16BitPCM(input, output) {\n    for (let i = 0; i < input.length; i++) {\n      const s = Math.max(-1, Math.min(1, input[i]))\n      output[i] = (s < 0 ? s * 0x8000 : s * 0x7FFF)\n    }\n  }\n\n  _convertBuffer(arrayBuffer) {\n    const data = new Float32Array(arrayBuffer)\n    const out = new Int16Array(arrayBuffer.length)\n    this._floatTo16BitPCM(data, out)\n    return out\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/encoder.js","\nexport default class VAD {\n\n  constructor(options) {\n    // Default options\n    this.options = {\n      fftSize: 512*.5,\n      bufferLen: 512*.5, \n      voice_stop: function() {},\n      voice_start: function() {},\n      smoothingTimeConstant: 0.99, \n      energy_offset: 1e-8, // The initial offset.\n      energy_threshold_ratio_pos: 4, // Signal must be twice the offset\n      energy_threshold_ratio_neg: 0.25, // Signal must be half the offset\n      energy_integration: 1, // Size of integration change compared to the signal per second.\n      filter: [\n        {f: 200, v:0}, // 0 -> 200 is 0\n        {f: 2000, v:1} // 200 -> 2k is 1\n      ],\n      source: null,\n      context: null,\n      debug: false,\n    };\n\n    // User options\n    for(var option in options) {\n      if(options.hasOwnProperty(option)) {\n        this.options[option] = options[option];\n      }\n    }\n\n    // Require source\n   if(!this.options.source)\n     throw new Error(\"The options must specify a MediaStreamAudioSourceNode.\");\n\n    // Set this.options.context\n    this.options.context = this.options.source.context;\n\n    // Calculate time relationships\n    this.hertzPerBin = this.options.context.sampleRate / this.options.fftSize;\n    this.iterationFrequency = this.options.context.sampleRate / this.options.bufferLen;\n    this.iterationPeriod = 1 / this.iterationFrequency;\n\n    var DEBUG = this.options.debug;\n    if(DEBUG) {console.log(\n      'Vad' +\n      ' | sampleRate: ' + this.options.context.sampleRate +\n      ' | hertzPerBin: ' + this.hertzPerBin +\n      ' | iterationFrequency: ' + this.iterationFrequency +\n      ' | iterationPeriod: ' + this.iterationPeriod\n    )};\n\n    this.setFilter = function(shape) {\n      this.filter = [];\n      for(var i = 0, iLen = this.options.fftSize / 2; i < iLen; i++) {\n        this.filter[i] = 0;\n        for(var j = 0, jLen = shape.length; j < jLen; j++) {\n          if(i * this.hertzPerBin < shape[j].f) {\n            this.filter[i] = shape[j].v;\n            break; // Exit j loop\n          }\n        }\n      }\n    }\n\n    this.setFilter(this.options.filter);\n\n    this.ready = {};\n    this.vadState = false; // True when Voice Activity Detected\n\n    // Energy detector props\n    this.energy_offset = this.options.energy_offset;\n    this.energy_threshold_pos = this.energy_offset * this.options.energy_threshold_ratio_pos;\n    this.energy_threshold_neg = this.energy_offset * this.options.energy_threshold_ratio_neg;\n\n    this.voiceTrend = 0;\n    this.voiceTrendMax = 10*1.5;\n    this.voiceTrendMin = -5;\n    this.voiceTrendStart = 2;\n    this.voiceTrendEnd = -5;\n    this.damper = 0.025\n    this.voiceTrendMin = this.voiceTrendEnd - this.damper/10;\n    // Create analyser \n    this.analyser = this.options.context.createAnalyser();\n    this.analyser.smoothingTimeConstant = this.options.smoothingTimeConstant; // 0.99;\n    this.analyser.fftSize = this.options.fftSize;\n\n    this.floatFrequencyData = new Float32Array(this.analyser.frequencyBinCount);\n\n    // Setup local storage of the Linear FFT data\n    this.floatFrequencyDataLinear = new Float32Array(this.floatFrequencyData.length);\n\n    // Connect this.analyser\n    this.options.source.connect(this.analyser); \n\n    // Create ScriptProcessorNode\n    this.scriptProcessorNode = this.options.context.createScriptProcessor(this.options.bufferLen, 1, 1);\n\n    // Connect scriptProcessorNode (Theretically, not required)\n    this.scriptProcessorNode.connect(this.options.context.destination);\n\n    // Create callback to update/analyze floatFrequencyData\n    var self = this;\n    this.scriptProcessorNode.onaudioprocess = function(event) {\n      self.analyser.getFloatFrequencyData(self.floatFrequencyData);\n      self.update();\n      self.monitor();\n    };\n\n    // Connect scriptProcessorNode\n    this.options.source.connect(this.scriptProcessorNode);\n\n    // log stuff\n    this.logging = false;\n    this.log_i = 0;\n    this.log_limit = 100;\n\n    this.triggerLog = function(limit) {\n      this.logging = true;\n      this.log_i = 0;\n      this.log_limit = typeof limit === 'number' ? limit : this.log_limit;\n    }\n\n    this.log = function(msg) {\n      if(this.logging && this.log_i < this.log_limit) {\n        this.log_i++;\n        console.log(msg);\n      } else {\n        this.logging = false;\n      }\n    }\n\n    this.update = function() {\n      // Update the local version of the Linear FFT\n      var fft = this.floatFrequencyData;\n      for(var i = 0, iLen = fft.length; i < iLen; i++) {\n        this.floatFrequencyDataLinear[i] = Math.pow(10, fft[i] / 10);\n      }\n      this.ready = {};\n    }\n\n    this.getEnergy = function() {\n      if(this.ready.energy) {\n        return this.energy;\n      }\n\n      var energy = 0;\n      var fft = this.floatFrequencyDataLinear;\n\n      for(var i = 0, iLen = fft.length; i < iLen; i++) {\n        energy += this.filter[i] * fft[i] * fft[i];\n      }\n\n      this.energy = energy;\n      this.ready.energy = true;\n\n      return energy;\n    }\n\n    this.monitor = function() {\n      var energy = this.getEnergy();\n      var signal = energy - this.energy_offset;\n\n      if(signal > this.energy_threshold_pos) {\n        this.voiceTrend = (this.voiceTrend + 1 > this.voiceTrendMax) ? this.voiceTrendMax : this.voiceTrend + 1;\n      } else if(signal < -this.energy_threshold_neg) {\n        this.voiceTrend = (this.voiceTrend - 1 < this.voiceTrendMin) ? this.voiceTrendMin : this.voiceTrend - 1*(this.vadState ? this.damper : 10);\n      } else {\n        // voiceTrend gets smaller\n        if(this.voiceTrend > 0) {\n          this.voiceTrend--;\n        } else if(this.voiceTrend < 0) {\n          this.voiceTrend++;\n        }\n      }\n\n      var start = false, end = false;\n      if(this.voiceTrend > this.voiceTrendStart) {\n        // Start of speech detected\n        start = true;\n      } else if(this.voiceTrend < this.voiceTrendEnd) {\n        // End of speech detected\n        end = true;\n      }\n\n      // Integration brings in the real-time aspect through the relationship with the frequency this functions is called.\n      var integration = signal * this.iterationPeriod * this.options.energy_integration;\n\n      // Idea?: The integration is affected by the voiceTrend magnitude? - Not sure. Not doing atm.\n\n      // The !end limits the offset delta boost till after the end is detected.\n      if(integration > 0 || !end) {\n        this.energy_offset += integration;\n      } else {\n        this.energy_offset += integration * 10;\n      }\n      this.energy_offset = this.energy_offset < 0 ? 0 : this.energy_offset;\n      this.energy_threshold_pos = this.energy_offset * this.options.energy_threshold_ratio_pos;\n      this.energy_threshold_neg = this.energy_offset * this.options.energy_threshold_ratio_neg;\n\n      // Broadcast the messages\n      if(start && !this.vadState) {\n        this.vadState = true;\n        this.options.voice_start();\n      }\n      if(end && this.vadState) {\n        this.vadState = false;\n        this.options.voice_stop();\n      }\n\n      this.log(\n        'e: ' + energy +\n        ' | e_of: ' + this.energy_offset +\n        ' | e+_th: ' + this.energy_threshold_pos +\n        ' | e-_th: ' + this.energy_threshold_neg +\n        ' | signal: ' + signal +\n        ' | int: ' + integration +\n        ' | voiceTrend: ' + this.voiceTrend +\n        ' | start: ' + start +\n        ' | end: ' + end\n      );\n\n      return signal;\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/vad.js","\nexport default class {\n\n  constructor(canvas_id, sourceNode, audioContext){\n    var self = this\n    this.canvas = document.getElementById(canvas_id)\n    this.canvasContext = this.canvas.getContext(\"2d\")\n    this.loop = false\n    this.sourceNode = sourceNode\n    this.audioContext = audioContext\n    this.analyser = audioContext.createAnalyser();\n    this.analyser.fftSize = 32;\n\n\n    this.sourceNode.connect(this.analyser);\n    \n    this.bufferLength = this.analyser.frequencyBinCount;\n    this.dataArray = new Uint8Array(this.analyser.fftSize);\n\n  }\n\n  stop(){\n    this.loop = false\n    var self = this\n    window.setTimeout(function(){self.clearFrame()}, 200)\n  }\n\n  start(){\n    this.canvas.width = this.canvas.clientWidth;\n    this.canvas.height = this.canvas.clientHeight;    \n    this.WIDTH = this.canvas.clientWidth;\n    this.HEIGHT = this.canvas.clientHeight;    \n    this.loop = true\n    this.renderFrame();\n  }\n\n  renderFrame() {\n    var self = this\n    if (self.loop){\n      \n        window.requestAnimationFrame(function(){self.renderFrame()});\n        self.analyser.getByteFrequencyData(self.dataArray);\n        // self.canvasContext.clearRect(0, 0, self.WIDTH, self.HEIGHT);\n        self.canvasContext.fillStyle = \"#333\";\n        self.canvasContext.fillRect(0, 0, self.WIDTH, self.HEIGHT);\n\n        var barWidth = parseInt((self.WIDTH / self.bufferLength))\n        var barHeight = 0\n        var x = 0;\n\n        for (var i = 0; i < self.bufferLength/2; i++) {\n          barHeight = parseInt(self.dataArray[i]/255*self.HEIGHT*.9);\n          \n          var h = 345\n          var s = parseInt(73 * ( self.HEIGHT/barHeight * .5) )\n          var l = parseInt(90 * ( barHeight/self.HEIGHT))\n          \n          self.canvasContext.fillStyle = \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\";\n          self.canvasContext.fillRect(2*x+1, self.HEIGHT - barHeight, 2*barWidth-2, barHeight);\n\n          x += barWidth;\n\n      }\n      \n    } else {\n      return;\n    }\n  }\n\n  clearFrame(){\n    var self = this\n    self.canvasContext.clearRect(0, 0, self.WIDTH, self.HEIGHT);\n    self.canvasContext.fillStyle = \"#333\";\n    self.canvasContext.fillRect(0, 0, self.WIDTH, self.HEIGHT);    \n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/visualize.js","import Encoder from './encoder'\nimport { convertTimeMMSS } from '../../../node_modules/vue-audio-recorder/src/lib/utils'\nimport VAD from '../../lib/vad.js'\nimport vis from './visualize'\n\nexport default class {\n  constructor (options = {}) {\n    this.beforeRecording = options.beforeRecording\n    this.pauseRecording  = options.pauseRecording\n    this.putRecording    = options.putRecording\n    this.afterRecording  = options.afterRecording\n    this.micFailed       = options.micFailed\n    this.voiceStop       = options.voiceStop\n    this.voiceStart      = options.voiceStart\n    this.visCanvasID     = options.canvasID\n\n    this.bitRate = options.bitRate || 96\n    this.sampleRate = options.sampleRate || 44100\n    this.bufferSize = 4096\n    this.records    = []\n\n    this.isPause     = false\n    this.isRecording = false\n\n    this.duration = 0\n    this.volume   = 0\n\n    this._duration = 0\n\n    this.vad = null\n    this.vis = null\n    this.activity = false\n    this.flush = false\n\n    this.vis = null\n\n    // Set Sample Rate according to device and browser campability\n    this.context = new(window.AudioContext || window.webkitAudioContext)()\n    this.sampleRate = this.context.sampleRate\n    this.context.close()\n  }\n\n\n\n  start () {\n    const constraints = {\n      video: false,\n      audio: {\n        channelCount: 1,\n        echoCancellation: true\n      }\n    }\n\n    this.beforeRecording && this.beforeRecording('start recording')\n\n    navigator.mediaDevices\n             .getUserMedia(constraints)\n             .then(this._micCaptured.bind(this))\n             .catch(this._micError.bind(this))\n    this.isPause = false\n    this.isRecording = true\n\n    this.lameEncoder = new Encoder({bitRate: this.bitRate , sampleRate: this.sampleRate })\n  }\n\n  stop () {\n    this.vis.stop()\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    const record = this.lameEncoder.finish()\n    record.duration = convertTimeMMSS(this.duration)\n    // this.records.push(record)\n\n    this._duration = 0\n    this.duration  = 0\n\n    this.isPause     = false\n    this.isRecording = false\n\n    this.afterRecording && this.afterRecording(record)\n    \n  }\n\n  put () {\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    const record = this.lameEncoder.finish()\n    record.duration = convertTimeMMSS(this.duration)\n    this.records.push(record)\n\n    this._duration = 0\n    this.duration  = 0\n\n    this.isPause     = false\n    this.isRecording = false\n    this.putRecording && this.putRecording(record)\n\n  }\n\n  pause () {\n    this.stream.getTracks().forEach((track) => track.stop())\n    this.input.disconnect()\n    this.processor.disconnect()\n    this.context.close()\n\n    this._duration = this.duration\n    this.isPause = true\n\n    this.pauseRecording && this.pauseRecording('pause recording')\n  }\n\n  recordList () {\n    return this.records\n  }\n\n  lastRecord () {\n    return this.records.slice(-1)\n  }\n\n  _micCaptured (stream) {\n    this.context    = new(window.AudioContext || window.webkitAudioContext)({sampleRate: this.sampleRate})\n    this.duration   = this._duration\n    this.input      = this.context.createMediaStreamSource(stream)\n    this.processor  = this.context.createScriptProcessor(this.bufferSize, 1, 1)\n    this.stream     = stream\n\n    this._voiceStop = () => {\n      this.voiceStop()\n      this.activity = false\n      this.put()\n      this.start()\n    }\n    this._voiceStart = () => {\n      this.voiceStart()\n      this.activity = true\n      this.flush = true\n    }\n\n    var options = {\n      debug: true,\n      source: this.input,\n      voice_stop: this._voiceStop,\n      voice_start: this._voiceStart,\n    }; \n        \n    // Create VAD\n    this.vad = new VAD(options)\n    \n    if (this.visCanvasID){\n      try{\n        this.vis = new vis(this.visCanvasID, this.input, this.input.context)\n        this.vis.start()\n      } catch(error){\n        console.log(error)\n      }\n    }\n\n    this.processor.onaudioprocess = (ev) => {\n      if (this.activity){\n        if (this.flush){\n          this.lameEncoder.flushPrevious(10*1.5)\n          this.flush = false\n        }\n      } else {\n      }\n      const sample = ev.inputBuffer.getChannelData(0)\n      let sum = 0.0\n\n      this.lameEncoder.encode(sample)\n\n      for (let i = 0; i < sample.length; ++i) {\n        sum += sample[i] * sample[i]\n      }\n\n      this.duration = parseFloat(this._duration) + parseFloat(this.context.currentTime.toFixed(2))\n      this.volume = Math.sqrt(sum / sample.length).toFixed(2)\n    }\n\n    this.input.connect(this.processor)\n    this.processor.connect(this.context.destination)\n  }\n\n  _micError (error) {\n    this.micFailed && this.micFailed(error)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/lib/recorder.js","<template>\n  <div class=\"Korero\">\n    <div class=\"header\">\n      <button id=\"startVAD\">{{buttonText}}</button>\n      <div id=\"vadStatus\" v-bind:class=\"{ active: vadOn }\">\n        <canvas id=\"canvas\"></canvas>\n      </div>\n    </div>\n\n    <div class=\"body\">\n      <div id=\"transcriptions\">\n        <div v-for=\"(item, index) in transcriptions\" class='transcription' v-if=\"item.status != 'Failed'\"> \n          <button class=\"delete\"  v-on:click=\"deleteObject(index)\">delete</button>\n          <div v-if=\"item.status == 'Transcribing'\" class=\"text\">\n            {{item.status}}\n          </div>\n          <div v-if=\"item.text\" class='text'>\n            {{item.text}}\n          </div>\n          <div class=\"audio\">\n            <audio v-if=\"item.audio_url\" :src=\"item.audio_url\" type=\"audio/mp3\" controls></audio>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport recorder from '../public/lib/recorder.js'\nconst ApiAuth = require('../../api_auth')\nconst api_auth = ApiAuth.api_auth;\nconst axios = require('axios');\nexport default {\n  name: 'Kōrero',\n  data () {\n    return {\n      vadOn: false,\n      recordingOn: false,\n      recorder: null,\n      buttonText: 'Start',\n      transcriptions: [],\n    }\n  },\n  methods: {\n    deleteObject: function (e) {\n      this.transcriptions.splice(e, 1)\n    },\n  },\n  mounted: function () {\n\n    startVAD.onclick = event => {\n\n      if (this.recorder==null){\n        this.recorder = new recorder({\n          putRecording : (record) => {\n            var transcription = {\n              status: 'Transcribing',\n              text: null,\n              audio: null,\n            }\n            this.transcriptions.push(transcription)\n\n            console.log(api_auth)\n            // var div = document.createElement('div')\n            // var xt = document.createElement('div')\n            // xt.innerText = 'Transcribing...'\n            // div.classList.add('transcription')\n            // xt.classList.add('text')\n            // // div.append(xt)\n            // transcriptions.insertBefore(div, transcriptions.firstChild)\n            var formData = new FormData();\n            formData.enctype=\"multipart/form-data\";\n            formData.append('audio_file', record.blob, 'audio_file.mp3')            \n            axios.post(\n              api_auth['url'],\n              formData,\n              {\n                headers: api_auth['headers'],\n              })\n            .then((response) => {\n              if (response.data.transcription == '' || response.data.transcription == ' ' ){\n                // div.remove()\n                this.transcriptions.pop()\n                transcription.status = 'Failed'\n                // transcription.delete()\n                return\n              }\n              // xt.innerText = response.data.transcription\n              transcription['text'] = response.data.transcription\n              transcription['audio_url'] = record.url\n              transcription['status'] = 'Success'\n              // var audio = document.createElement('audio')\n              // audio.controls = 'controls';\n              // audio.src =  record.url;\n              // audio.type = 'audio/mp3';\n              // // div.append(audio)\n\n\n\n            })\n            .catch((error) => {\n              transcription.status = 'Failed'\n              // transcription.delete()\n              this.transcriptions.pop()\n            })\n\n          },\n          afterRecording  : (stream) =>{\n            startVAD.classList.remove('on')\n            this.buttonText = 'Start'            \n            this.recorder=null;\n          },\n          pauseRecording  : function(){console.log('paused')},\n          micFailed       : function(){console.log('failed')},\n          voiceStop: () => {\n            \n            this.vadOn = false\n          },\n          voiceStart: () => {\n            this.vadOn = true\n\n          },\n          canvasID: 'canvas',\n          bitRate         : 64,\n          sampleRate      : 44100,\n          // format          : this.format\n        })\n      }\n\n      if (startVAD.classList.contains('on')){\n        this.recorder.stop();\n        startVAD.classList.remove('on')\n        this.recorder=null;\n        this.vadOn = false;\n        // this.buttonText = 'Start'\n      } else {\n        this.recorder.start()\n        startVAD.classList.add('on')\n        this.buttonText = 'Stop'\n      }\n      \n\n      }\n  }\n}\n</script>\n\n<style scoped>\nbutton.delete{\n  position: absolute;\n  right: 0px;\n  top: 0px;\n  display: block;\n  margin: 15px;  \n}\n.transcription{\n  position: relative;\n  width: 100%;\n  margin: 20px 30px 20px 30px;\n  max-width: 500px;\n  /*margin-top: 20px; */\n  font-size: 1.5em;\n  border-radius: 8px;\n  /*box-shadow: 0px 2px 6px -2px rgba(0,0,0,1)  */\n  border: 1px solid black;\n}\n\n.transcription .text {\n  padding-top: 15px;\n  padding-bottom: 15px\n}\n\n.Korero, .header, .body{\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n.body{\n  height: 100vh;\n  margin-top: -463px;\n  padding-top: 250px;\n}\n.header{\n  padding-bottom: 15px;\n  z-index: 1;\n  background-color: white;\n  /*box-shadow: 0 -2px 10px black;*/\n  border-bottom: 2px solid black;\n}\n#transcriptions{\n  z-index: 0;\n  overflow-y: scroll;  \n  display: flex;\n  flex-direction: column-reverse;\n  justify-content: flex-end;\n  align-items: center;  \n  margin-top: 215px;\n  height: 100vh;    \n  /*border-top: 2px solid black;*/\n}\n\n#vadStatus{\n  display: flex;\n  width: 100%;\n  max-width: 560px;  \n  height: 100px;\n  align-self: center;\n  align-items: center;\n  border: 4px solid black;\n  border-radius: 4px;\n\n}\n#vadStatus.active{\n  background-color: red;\n  border: 4px solid red;\n}\n#vadStatus canvas{\n  z-index: 1;\n  display: block;\n  height: 100%;\n  width: 100%;\n  background-color: #333;\n}\n#startVAD {\n  z-index: 2;\n  align-self: center;\n  margin: 15px;\n  outline: none;\n  background-color: rgb(40,40,40);\n  color: white;\n  width: 150px;\n  font-size: 2em;\n  border: 2px solid black;\n  border-radius: 8px;\n  padding: 8px 16px;\n  cursor: pointer;\n}\n#startVAD.on {\n  background-color: rgb(255, 40, 40);\n  border-color: rgb(200, 40, 40);;\n}\naudio{\n  outline: none;\n  width: 100%;\n  padding-bottom: 15px;\n}\n.audio{\n  padding: 0px 15px 0px 15px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Korero.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"Korero\"},[_c('div',{staticClass:\"header\"},[_c('button',{attrs:{\"id\":\"startVAD\"}},[_vm._v(_vm._s(_vm.buttonText))]),_vm._v(\" \"),_c('div',{class:{ active: _vm.vadOn },attrs:{\"id\":\"vadStatus\"}},[_c('canvas',{attrs:{\"id\":\"canvas\"}})])]),_vm._v(\" \"),_c('div',{staticClass:\"body\"},[_c('div',{attrs:{\"id\":\"transcriptions\"}},_vm._l((_vm.transcriptions),function(item,index){return (item.status != 'Failed')?_c('div',{staticClass:\"transcription\"},[_c('button',{staticClass:\"delete\",on:{\"click\":function($event){return _vm.deleteObject(index)}}},[_vm._v(\"delete\")]),_vm._v(\" \"),(item.status == 'Transcribing')?_c('div',{staticClass:\"text\"},[_vm._v(\"\\n          \"+_vm._s(item.status)+\"\\n        \")]):_vm._e(),_vm._v(\" \"),(item.text)?_c('div',{staticClass:\"text\"},[_vm._v(\"\\n          \"+_vm._s(item.text)+\"\\n        \")]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"audio\"},[(item.audio_url)?_c('audio',{attrs:{\"src\":item.audio_url,\"type\":\"audio/mp3\",\"controls\":\"\"}}):_vm._e()])]):_vm._e()}),0)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-19c1666f\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Korero.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-19c1666f\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Korero.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Korero.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Korero.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-19c1666f\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Korero.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-19c1666f\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Korero.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Korero from '@/components/Korero'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'VAD Kōrero Māori API Demo',\n      component: Korero\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","import Vue from 'vue'\nimport App from './App'\nimport router from './router'\n\nimport vueCustomElement from 'vue-custom-element'\nVue.use(vueCustomElement)\n\n// Vue.config.productionTip = false\n\nApp.router = router\nVue.customElement('vue-widget', App)\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}